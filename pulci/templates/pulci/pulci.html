{% load staticfiles %}
<html>
<head>
    <link rel="stylesheet" type="text/css" href="{% static 'pulci/style.css' %}" />
</head>
<script>
    function vote(id) {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                document.getElementById("counter1"+id).innerHTML = xmlhttp.responseText;
                document.getElementById("counter2"+id).innerHTML = xmlhttp.responseText;

                 img = document.getElementById("img1"+id);
                 img.onclick = ""; img.onmouseover = ""; img.onmouseout = "";

                 img = document.getElementById("img2"+id);
                 img.onclick = ""; img.onmouseover = ""; img.onmouseout = "";

                standart_cursor();
                }
         }
         url = 'vote' + id
         xmlhttp.open('GET', url, true)
         xmlhttp.send()
    }

    function change_cursor() {
        document.getElementsByTagName("body")[0].style.cursor = 'pointer';
    }

    function standart_cursor() {
        document.getElementsByTagName("body")[0].style.cursor = 'auto';
    }

    function select(id) {
        element = document.getElementById(id);
        element.style.borderColor = 'red';
        element.style.backgroundColor = 'white';
    }

    function unselect(id) {
        element = document.getElementById(id);
        element.style.borderColor = 'black';
        element.style.backgroundColor = '#e0e0e0';
    }

    var current_modal = null;

    function show(id) {
        if (current_modal) {
             current_modal.style.display = "none";
             }
        modal = document.getElementById("detail"+id);
        modal.style.display = "block";
        current_modal = modal;
     }

     function close_modal(id) {
        modal = document.getElementById("detail"+id);
        modal.style.display = "none";
        current_modal = null;
     }

     function switch_from_to(from, to) {
        close_modal(from);
        show(to);
        current_modal = to;
     }

</script>
<body>
<div id="fb-root"></div>
<!--
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/cs_CZ/sdk.js#xfbml=1&version=v2.7";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
-->

<div class="main">
<h1 id="header"> Veselé hlášky našich pulců </h1>


{%  if citation_list %}

        {% for cit, votable, previous, next in citation_list %}
    <!--- modal window -->
    <div class="modal" id="detail{{ cit.id }}">
        <div class="modalheader">
        <span class="leftarrow" onclick="switch_from_to({{ cit.id }}, {{ previous }})"
            onmouseover="change_cursor()" onmouseout="standart_cursor()"> < </span>
        <span class="rightarrow" onclick="switch_from_to({{ cit.id }}, {{ next }})"
            onmouseover="change_cursor()" onmouseout="standart_cursor()">></span>
        </div>
        <div class="modalcontent">
           {{ cit.text | linebreaks }}
        </div>
        <div class="modalinfo">
            <small style="color: blue">(<span style="color:red"> {{cit.get_who_display }}</span>, {{ cit.date }})
                    {% if not votable %}
                        <img src="{% static 'pulci/img/thumbup.gif' %}" width="50px"/>
                    {% else %}
                        <img id="img1{{ cit.id }}" class="button" src="{% static 'pulci/img/thumbup.gif' %}" width="50px"
                             onclick="vote( {{ cit.id }}, 1 )" onmouseover="change_cursor()" onmouseout="standart_cursor()"/>
                    {% endif %}
                    <span id="counter1{{ cit.id }}">{{ cit.likes }}</span> </small>
        <br>
        <div class="fb-like" data-href="http://127.0.0.1:8000/pulci/" data-width="50" data-layout="standard" data-action="like" data-size="small" data-show-faces="false" data-share="true"></div>
        </div>
            <span style="float:right"><button onclick="close_modal({{ cit.id }})" onmouseover="change_cursor()" onmouseout="standart_cursor()"> Zavřít </button></span>
    </div>

    <!---- boxes with citations -->
    <div class="box" id="{{cit.id}}" onmouseover="select('{{cit.id}}')" onmouseleave="unselect('{{cit.id}}')">

        <div class="info">
                <small style="color: blue">(<span style="color:red"> {{cit.get_who_display }}</span>,
                    {{ cit.date | date:'d. m. Y' }})
                    {% if not votable %}
                        <img src="{% static 'pulci/img/thumbup.gif' %}" width="50px"/>
                    {% else %}
                        <img id="img2{{ cit.id }}" class="button" src="{% static 'pulci/img/thumbup.gif' %}" width="50px"
                             onclick="vote( {{ cit.id }}, 2)" onmouseover="change_cursor()" onmouseout="standart_cursor()"/>
                    {% endif %}
                    <span id="counter2{{ cit.id }}">{{ cit.likes }}</span> </small>
                    <img src="{% static 'pulci/img/lupa.png' %}" width="30px"
                         onclick="show({{ cit.id }})" onmouseover="change_cursor()" onmouseout="standart_cursor()"/>
                    </div>
                 <hr>
                 {{ cit.text | linebreaks }}
            </div>
        {% endfor %}
{% endif %}
</div>
<div class="footer">
        (c) Petra Vidnerová
        <span class="left"><img src="{% static 'main/img/django.jpg' %}" width="100em"/>
            <a href="http://www.toplist.cz/"><script language="JavaScript" type="text/javascript">
<!--
document.write('<img src="https://toplist.cz/count.asp?id=1729530&logo=btn&http='+escape(document.referrer)+'&t='+escape(document.title)+
'" width="80" height="15" border=0 alt="TOPlist" />');
//--></script><noscript><img src="https://toplist.cz/count.asp?id=1729530&logo=btn" border="0"
alt="TOPlist" width="80" height="15" /></noscript></a>
        </span>
    </div>
</body>
</html>